<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>TommyDS</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="tommy.css" rel="stylesheet" type="text/css">
</head>
<body>

<!-- Generated by Doxygen 1.7.3 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>Tommy Multi Indexing </h1>  </div>
</div>
<div class="contents">
<div class="textblock"><p>Tommy doesn't provide iterators support to iterate over all the elements inside a data structure.</p>
<p>To do that you have to manually insert any objects also in a <a class="el" href="tommylist_8h.html#a45d098412d5f0be21113b252caee491b" title="Double linked list for collisions into hashtables.">tommy_list</a>, and use the list as iterator.</p>
<p>This technique allows to keep track of the insertion order with the list, and provide more search possibilities using different data structures for different search keys.</p>
<p>See the next example, for an object that is inserted in a <a class="el" href="tommylist_8h.html#a45d098412d5f0be21113b252caee491b" title="Double linked list for collisions into hashtables.">tommy_list</a>, and in two <a class="el" href="tommytrie_8h.html#a05c17b0ace098768808aa9effcaa9559" title="Trie optimized for cache utilization.">tommy_trie</a> using different keys.</p>
<div class="fragment"><pre class="fragment"> <span class="keyword">struct </span>object {
     <a class="code" href="structtommy__node__struct.html" title="Data structure node.">tommy_node</a> list_node; <span class="comment">// node for the list</span>
     <a class="code" href="structtommy__node__struct.html" title="Data structure node.">tommy_node</a> trie_node_0; <span class="comment">// node for the first trie</span>
     <a class="code" href="structtommy__node__struct.html" title="Data structure node.">tommy_node</a> trie_node_1; <span class="comment">// node for the second trie</span>
     <span class="comment">// other fields</span>
     <span class="keywordtype">int</span> value_0;
     <span class="keywordtype">int</span> value_1;
 };

 <a class="code" href="structtommy__allocator__struct.html" title="Allocator of fixed size blocks.">tommy_allocator</a> alloc;
 <a class="code" href="structtommy__trie__struct.html" title="Trie optimized for cache utilization.">tommy_trie</a> trie_0;
 <a class="code" href="structtommy__trie__struct.html" title="Trie optimized for cache utilization.">tommy_trie</a> trie_1;
 <a class="code" href="structtommy__node__struct.html" title="Data structure node.">tommy_list</a> list;

 <span class="comment">// initializes the allocator, the tries and the list</span>
 <a class="code" href="tommyalloc_8h.html#a229894e4a2db888229e2b77084be193b" title="Initializes the allocator.">tommy_allocator_init</a>(&amp;alloc, <a class="code" href="tommytrie_8h.html#a12bee56b6b3ae6ee817d641f148220f1" title="Trie block size.">TOMMY_TRIE_BLOCK_SIZE</a>, <a class="code" href="tommytrie_8h.html#a12bee56b6b3ae6ee817d641f148220f1" title="Trie block size.">TOMMY_TRIE_BLOCK_SIZE</a>);
 <a class="code" href="tommytrie_8h.html#ac6f775ce5ef3dcf2b5d0bf0588f39e7c" title="Initializes the trie.">tommy_trie_init</a>(&amp;trie_0, &amp;alloc);
 <a class="code" href="tommytrie_8h.html#ac6f775ce5ef3dcf2b5d0bf0588f39e7c" title="Initializes the trie.">tommy_trie_init</a>(&amp;trie_1, &amp;alloc);
 <a class="code" href="tommylist_8h.html#a2fc05289c0e8797ffe45e28b9d3671ff" title="Initializes the list.">tommy_list_init</a>(&amp;list);

 ...

 <span class="comment">// inserts an object</span>
 <span class="keyword">struct </span>object* obj = ...
 <a class="code" href="tommytrie_8h.html#a7f48a4942d6b607c24b7236ab257b7d7" title="Inserts an element in the trie.">tommy_trie_insert</a>(&amp;trie_0, &amp;obj-&gt;trie_node_0, obj, obj-&gt;value0); <span class="comment">// inserts in the first trie</span>
 <a class="code" href="tommytrie_8h.html#a7f48a4942d6b607c24b7236ab257b7d7" title="Inserts an element in the trie.">tommy_trie_insert</a>(&amp;trie_1, &amp;obj-&gt;trie_node_1, obj, obj-&gt;value1); <span class="comment">// inserts in the second trie</span>
 <a class="code" href="tommylist_8h.html#a98e34efdc68731f3e6da976e4d54ef63" title="Inserts an element at the tail of a list.">tommy_list_insert_tail</a>(&amp;list, &amp;obj-&gt;list_node, obj); <span class="comment">// inserts in the list</span>

 ...

 <span class="comment">// searches an object and delete it</span>
 <span class="keyword">struct </span>object* obj = <a class="code" href="tommytrie_8h.html#a1170abedabdc9d919db8728d238c50db" title="Searches an element in the trie.">tommy_trie_search</a>(&amp;trie_1, value1_to_find);
 <span class="keywordflow">if</span> (obj) {
     <span class="comment">// if found removes all the references</span>
     <a class="code" href="tommytrie_8h.html#a096cf4116065eff7ddf5a430c357519d" title="Removes an element from the trie.">tommy_trie_remove_existing</a>(&amp;trie_0, &amp;obj-&gt;trie_node_0);
     <a class="code" href="tommytrie_8h.html#a096cf4116065eff7ddf5a430c357519d" title="Removes an element from the trie.">tommy_trie_remove_existing</a>(&amp;trie_1, &amp;obj-&gt;trie_node_1);
     <a class="code" href="tommylist_8h.html#ad2dfbf52d6cd1a3f55d0822e90386905" title="Removes an element from the list.">tommy_list_remove_existing</a>(&amp;list, &amp;obj-&gt;list_node);
 }

 ...

 <span class="comment">// iterates over all the elements using the list, and delete them</span>
 <a class="code" href="structtommy__node__struct.html" title="Data structure node.">tommy_node</a>* i = <a class="code" href="tommylist_8h.html#aa9e7b5d591c265d71d518e27f7589d47" title="Gets the head of the list.">tommy_list_head</a>(&amp;list);
 <span class="keywordflow">while</span> (i) {
     <a class="code" href="structtommy__node__struct.html" title="Data structure node.">tommy_node</a>* i_next = i-&gt;<a class="code" href="structtommy__node__struct.html#a53338f3f5366866598ed9ac7e46e64a2" title="Next node.">next</a>; <span class="comment">// saves the next element before freeing</span>

     <span class="comment">// removes all the references</span>
     <a class="code" href="tommytrie_8h.html#a096cf4116065eff7ddf5a430c357519d" title="Removes an element from the trie.">tommy_trie_remove_existing</a>(&amp;trie_0, &amp;obj-&gt;trie_node_0);
     <a class="code" href="tommytrie_8h.html#a096cf4116065eff7ddf5a430c357519d" title="Removes an element from the trie.">tommy_trie_remove_existing</a>(&amp;trie_1, &amp;obj-&gt;trie_node_1);
     <a class="code" href="tommylist_8h.html#ad2dfbf52d6cd1a3f55d0822e90386905" title="Removes an element from the list.">tommy_list_remove_existing</a>(&amp;list, &amp;obj-&gt;list_node);

     free(i-&gt;<a class="code" href="structtommy__node__struct.html#a6210792ec52fa1efbfb44cf4557d9b6f" title="Pointer at the object containing the node.">data</a>); <span class="comment">// frees the object allocated memory</span>

     i = i_next; <span class="comment">// goes to the next element</span>
 }
</pre></div> </div></div>
</body>
</html>
